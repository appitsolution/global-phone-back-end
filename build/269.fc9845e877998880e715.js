"use strict";(self.webpackChunkpayload_template_js_blank=self.webpackChunkpayload_template_js_blank||[]).push([[269],{8269:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var i=a(67294),l=a(16550),o=a(26793),s=a(9980),n=a(28630),d=a(47489),r=a(2143),u=a(29007),c=a(58938),p=a(19826),v=a(40684),f=a(45074),m=a(91455),$=a(30894);const g=e=>{var t,a;const{collection:g,isEditing:k}=e,{slug:S,admin:{components:{views:{Edit:h}={}}={}}={}}=g,[E]=(0,i.useState)((()=>(0,c.Z)(g,k))),[b]=(0,i.useState)((()=>({...g,fields:E}))),[P,Z]=(0,i.useState)(),_=(0,v.bU)(),{serverURL:w,routes:{admin:C,api:y}}=(0,s.Z)(),{params:{id:A}={}}=(0,l.$B)(),{state:L}=(0,l.TH)(),U=(0,l.k6)(),[j,D]=(0,i.useState)(),[R,x]=(0,i.useState)(),{user:B}=(0,n.a)(),{getVersions:G,preferencesKey:H,getDocPermissions:K,docPermissions:T}=(0,f.x)(),{getPreference:V}=(0,m.G)(),{t:q}=(0,o.$)("general"),z=(0,i.useCallback)((async e=>{var t,a;if(G(),K(),x(null===(t=null==e?void 0:e.doc)||void 0===t?void 0:t.updatedAt),k){const t=await(0,p.Z)({fieldSchema:b.fields,data:e.doc,user:B,id:A,operation:"update",locale:_,t:q});D(t)}else Z(`${C}/collections/${b.slug}/${null===(a=null==e?void 0:e.doc)||void 0===a?void 0:a.id}`)}),[C,b,k,G,B,A,q,_,K]),[{data:F,isLoading:I,isError:J}]=(0,d.Z)(k?`${w}${y}/${S}/${A}`:null,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),M=(null==L?void 0:L.data)||F;if((0,i.useEffect)((()=>{if(I)return;(async()=>{x(null==M?void 0:M.updatedAt);const e=await(0,p.Z)({fieldSchema:E,data:M,user:B,operation:k?"update":"create",id:A,locale:_,t:q});await V(H),D(e)})()}),[M,E,k,A,B,_,I,H,V,q]),(0,i.useEffect)((()=>{P&&U.push(P)}),[U,P]),J)return i.createElement(l.l_,{to:`${C}/not-found`});const N=`${w}${y}/${S}/${A}${b.versions.drafts?"?draft=true":""}`,O=`${w}${y}/${S}${k?`/${A}`:""}?locale=${_}&depth=0&fallback-locale=null`,Q=k&&(null===(t=null==T?void 0:T.update)||void 0===t?void 0:t.permission)||!k&&(null===(a=null==T?void 0:T.create)||void 0===a?void 0:a.permission);return i.createElement($.f.Provider,{value:1},i.createElement(r.Z,{DefaultComponent:u.Z,CustomComponent:h,componentProps:{id:A,isLoading:!j||!T,data:M,collection:b,permissions:T,isEditing:k,onSave:z,initialState:j,hasSavePermission:Q,apiURL:N,action:O,updatedAt:R||(null==M?void 0:M.updatedAt)}}))}}}]);